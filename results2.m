clear all;
clc;
%for model-free methods, AB codes
%n=196, 5.7*10^7 L vectors took 13hrs training
snr=[0 0.6 1.2 1.4 1.8 2 2.2];


BER_fl=[0.119678 0.0899304 0.0549901 0.0466926 0.0254606 0.0185611 0.0116388;
        0.123172 0.0914568 0.0570049 0.0441613 0.0240629 0.0175598 0.0118801;
        0.122509 0.0939014 0.0574734 0.0465053 0.0258584 0.0169557 0.0116089];
    
BER_GI=[0.048376 0.0370406 0.0279918 0.024139 0.017994 0.0159153 0.0132008;
        0.0494049 0.0356401 0.0261757 0.024343 0.0180818 0.0155903 0.0148112;
        0.0494275 0.0382395 0.025288 0.0241601 0.0186533 0.0158287 0.013748]; 
    
BER_NS=[ 0.0284786 0.0199961 0.0124264 0.0102078 0.00773513 0.00633025 0.00478351;
         0.0302154 0.0203428 0.0133534 0.0111197 0.00714552 0.00643103 0.00500216;
         0.0283908 0.0200857 0.0134603 0.0103543 0.00797129 0.00644054 0.00524312];
     
BER_RL=[ 0.0158169 0.0127409 0.0095562 0.00943549 0.00745121 0.00681666 0.00572083;
         0.0159652 0.0126102 0.00887778 0.00906717 0.00722582 0.00618526 0.0057815;
         0.0163937 0.0131732 0.0110656 0.0096394 0.00791953 0.00692304 0.00599634];
    
BER_RL_ran=[0.0115686 0.0102978 0.00782285 0.00701583 0.00571129 0.00563891 0.00463878;
            0.0110352 0.00918578 0.00729808 0.00757034 0.00570952 0.00484499 0.00477235;
            0.00881364 0.00733902 0.00656681 0.00608456 0.00518527 0.0045018 0.00394413]; %random clustering
     
BER_RL_opt=[0.00809599 0.00634152 0.00518053 0.00500648 0.00419185 0.00397629 0.0036979;
            0.00828948 0.00706206 0.00548448 0.0053131 0.00421792 0.00387341 0.00369447;
            0.00947438 0.00767642 0.0060891 0.00540985 0.0045169 0.00425504 0.00388064]; %optimized clustering
        
% BER_BCH=[0.1624    0.1459    0.1298    0.1245    0.1109    0.1068    0.0970;
%          0.1632    0.1450    0.1278    0.1213    0.1127    0.1062    0.0953;
%          0.1616    0.1448    0.1295    0.1224    0.1144    0.1038    0.0991]; %(255,123) code
     
BER_TS1=[0.0400564 0.0319522 0.022556 0.0183378 0.0162338 0.0132588 0.0111588;
         0.0400564 0.0319522 0.020556 0.0183378 0.0162338 0.0132588 0.0111588;
         0.0431272 0.0302407 0.0222955 0.0180548 0.0153606 0.0130963 0.0126226;
         0.0468712 0.0310803 0.0190389 0.0215261 0.0161296 0.0126157 0.013129];      
    

%BER_NN=[0.00778733 0.00867347 0.0072606 0.0055457 0.00753158]; %using deep RL

ncv_fl=[29042.6 27871.6 21156.6 19000.2 11642.8 8701.88 5570.12;
        29244.9 27467.1 21816.9 17943.5 10866.1 8046.63 5652.7;
        29172.7 27720.6 22550 18558.9 10803.1 7760.04 5486.34];

ncv_GI=[412.535 362.773 323.119 299.299 256.163 240.521 220.127;
        419.315 354.114 293.679 299.693 257.734 243.808 233.396;
        415.161 368.251 294.188 293.712 261.262 243.79 221.605];   

ncv_NS=[392.728 352.638 289.19 273.252 258.399 229.686 216.54;
        407.847 361.214 313.809 296.238 249.717 245.72 217.879;
        394.189 342.974 303.993 283.55 260.459 239.711 222.42]; 

ncv_RL=[378.365 339.714 294.8 282.48 257.291 239.871 223.935;
        389.709 351.415 280.484 292.699 261.612 239.108 227.762;
        379.097 337.444 323.515 289.952 261.983 242.149 227.643];  

ncv_RL_ran=[388.902 370.857 307.557 305.207 262.637 265.328 231.39;
            427.558 375.466 318.406 322.552 273.516 242.286 243.025;
             397.231 346.182 322.996 318.155 266.298 252.599 226.582]; 

ncv_RL_opt=[397.231 344.384 300.065 301.616 262.185 254.721 246.608;
            380.201 356.446 314.249 295.414 258.175 240.963 232.628;
            415.543 369.811 324.82 305.686 253.352 247.608 231.636]; 


% hold on
semilogy(snr,mean(BER_fl),'-.ob',snr,mean(BER_GI),'-.*',snr,mean(BER_NS),'-.<r',snr,mean(BER_RL),'-.^',snr,mean(BER_RL_ran),'-.s',...
    snr,mean(BER_RL_opt),'-.dc',snr,mean(BER_TS1),'-.k*','LineWidth',4,'markers',15) 

% title ('Results for (3,7) AB-LDPC code, n=196')
xlabel ('$E_b/N_0$ (dB)','interpreter','latex')
ylabel ('BER','interpreter','latex')
% ylabel ('BLER')

% l=legend('flooding',... 
%         'GI',...
%         'NS',...
%         'Q-learning',...
%         'location','northeast')

l=legend( 'flooding',... 
        'MGI',...
        'NS',...
        'MQC',...
        'MQR',...
        'MQO',...
        'TS',...
        'location','northeast')
        
l.FontSize=20;

grid on
set(legend,'Interpreter','latex');
set(gca,'fontsize',22)
orient(figure(1),'landscape')
print('res','-dpdf','-fillpage')

mean(ncv_fl)
mean(ncv_GI)
mean(ncv_NS)
mean(ncv_RL)
mean(ncv_RL_ran)
mean(ncv_RL_opt)

% figure(2)
% semilogy(snr,mean(ncv_fl),'-.o',snr,mean(ncv_ran),'-.*',snr,mean(ncv_res),'-.<',snr,mean(ncv_RL),'-.s','LineWidth',4,'markers',15) 
%     
% title ('Results for regular (3,6) LDPC code, n=32', 'Fontsize', 20)
% xlabel ('E_b/N_0 (dB)')
% ylabel ('mean no. of CN to VN msgs. for 20 iters.')
% % ylabel ('BLER')
% 
% legend( 'flooding sch.',... 
%         'random sch.',...
%         'residual sch.',...
%         'RL sch.',...
%         'location','southwest')
% 
% grid on
% set(legend,'Interpreter','latex');
% set(gca,'fontsize',22)
% orient(figure(2),'landscape')
% print('res2','-dpdf','-fillpage')

