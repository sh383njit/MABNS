clear all;
clc;
%for model-free methods, non-AB codes
%n=196, 5.7*10^7 L vectors took 13hrs training
snr=[0 0.6 1.2 1.4 1.8 2 2.2];


BER_fl=[0.12641 0.0936975 0.0542656 0.0438109 0.0199443 0.0150227 0.00976695;
        0.125179 0.08704 0.0531569 0.0398267 0.0235998 0.0157931 0.0112847;
        0.126634 0.0901223 0.052345 0.0430029 0.0222187 0.0147759 0.0106636];
    
BER_GI=[0.0462345 0.0358139 0.025297 0.0241595 0.0202626 0.0169685 0.0147627;
        0.0460783 0.0351663 0.0266603 0.0240244 0.01861 0.0171464 0.0148052;
        0.0432385 0.0346463 0.0261314 0.0252809 0.0199261 0.0166894 0.0139935]; 
    
BER_NS=[0.0252597 0.0172188 0.0118062 0.0104931 0.00701833 0.00606246 0.00490161;
        0.0248401 0.0165202 0.0109081 0.00944795 0.00752754 0.00631636 0.00493952;
        0.0252595 0.0165783 0.0113428 0.00981634 0.00724536 0.00599229 0.00534943];
     
BER_RL=[0.00784485 0.00615219 0.00539002 0.00461237 0.00399516 0.00351346 0.00320105;
        0.00739343 0.00631879 0.00508646 0.00469959 0.00391134 0.00385091 0.00316487;
        0.00790147 0.00657378 0.00545364 0.00537077 0.00441002 0.00416754 0.00400543];
    
BER_RL_ran=[0.00955944 0.0076675 0.00651739 0.00594499 0.00504643 0.00470766 0.00422714;
            0.0081821 0.00646581 0.00552327 0.00517017 0.00430485 0.00417595 0.00369961;
            0.00930157 0.00779229 0.00556065 0.0051059 0.00451576 0.00414228 0.00383124]; 
     
BER_RL_opt=[0.00604586 0.00490429 0.00408755 0.00377743 0.00308762 0.00285766 0.00273667;
            0.0076101 0.00629738 0.00505318 0.00494416 0.00416836 0.00368321 0.00337741;
            0.00792422 0.00716436 0.00559485 0.00516982 0.00444586 0.00415648 0.00370892]; 
        
% BER_BCH=[0.1624    0.1459    0.1298    0.1245    0.1109    0.1068    0.0970;
%          0.1632    0.1450    0.1278    0.1213    0.1127    0.1062    0.0953;
%          0.1616    0.1448    0.1295    0.1224    0.1144    0.1038    0.0991]; %(255,123) code
     
BER_TS1=[0.0386751 0.0282283 0.0193286 0.0182871 0.0170501 0.0131078 0.0119363;
         0.0399479 0.0330835 0.0222672 0.0188482 0.0164518 0.0144952 0.0118294;
         0.0365646 0.0264991 0.0211961 0.0184791 0.0126612 0.0115116 0.0110902;
         0.0351586 0.0294893 0.0199893 0.0189834 0.0150294 0.014679 0.00992277]; 
    

ncv_fl=[29011.1 26986.7 18558.9 16116.4 7985.35 6132.02 4252.78;
        28746.2 25910.9 18295.8 14463.1 9446.63 6405.96 4949.03;
        28716.4 26360.7 18456.8 15768.1 8952.62 6204.59 4812.74];

ncv_GI=[337.096 291.948 242.881 250.275 229.592 209.352 199.669;
        335.377 297.901 260.321 246.231 213.913 211.067 198.836;
        315.006 287.364 250.256 255.255 230.482 211.319 189.385];   

ncv_NS=[332.081 295.278 242.386 252.878 222.818 207.91 192.471;
        323.119 282.503 249.581 238.345 227.06 207.91 190.198;
        332.538 276.261 252.291 242.041 213.667 201.444 192.89]; 

ncv_RL=[320.626 286.295 266.628 246.91 219.254 204.791 187.08;
        292.908 284.163 243.847 224.557 211.744 213.848 180.437;
        293.775 264.883 244.557 243.921 208.261 209.152 198.893];  

ncv_RL_ran=[335.015 295.698 263.223 251.668 220.185 224.557 201.013;
            336.704 297.031 266.628 250.237 219.685 216.9 203.104;
            318.479 290.464 239.766 241.852 221.089 212.112 201.122]; 

ncv_RL_opt=[328.44 303.07 262.608 259.872 220.052 205.246 204.678;
            327.183 298.286 253.848 258.586 221.428 204.791 193.014;
            321.214 299.862 257.766 236.546 222.074 212.668 195.327]; 
        
ncv_TS=[322.694 276.891 220.915 240.18 235.375 210.907 202.889;
        331.277 327.25 258.559 231.712 226.105 215.682 184.355];

% hold on
figure(1)
semilogy(snr,mean(BER_fl),'-.ob',snr,mean(BER_GI),'-.*',snr,mean(BER_NS),'-.<r',snr,mean(BER_RL),'-.^',snr,mean(BER_RL_ran),'-.s',...
    snr,mean(BER_RL_opt),'-.dc',snr,mean(BER_TS1),'-.k*','LineWidth',4,'markers',15) 

% title ('Results for (3,6) LDPC code, n=196')
xlabel ('$E_b/N_0$ (dB)','interpreter','latex')
ylabel ('BER','interpreter','latex')
% ylabel ('BLER')

% l=legend('flooding',... 
%         'GI',...
%         'NS',...
%         'Q-learning',...
%         'location','northeast')

l=legend( 'flooding',... 
        'MGI',...
        'NS',...
        'MQC',...
        'MQR',...
        'MQO',...
        'TS',...
        'location','northeast')
        
l.FontSize=20;

grid on
set(legend,'Interpreter','latex');
set(gca,'fontsize',22)
orient(figure(1),'landscape')
print('res','-dpdf','-fillpage')

mean(ncv_fl)
mean(ncv_GI)
mean(ncv_NS)
mean(ncv_RL)
mean(ncv_RL_ran)
mean(ncv_RL_opt)


% figure(2)
% semilogy(snr,mean(ncv_fl),'-.o',snr,mean(ncv_ran),'-.*',snr,mean(ncv_res),'-.<',snr,mean(ncv_RL),'-.s','LineWidth',4,'markers',15) 
%     
% title ('Results for regular (3,6) LDPC code, n=32', 'Fontsize', 20)
% xlabel ('E_b/N_0 (dB)')
% ylabel ('mean no. of CN to VN msgs. for 20 iters.')
% % ylabel ('BLER')
% 
% legend( 'flooding sch.',... 
%         'random sch.',...
%         'residual sch.',...
%         'RL sch.',...
%         'location','southwest')
% 
% grid on
% set(legend,'Interpreter','latex');
% set(gca,'fontsize',22)
% orient(figure(2),'landscape')
% print('res2','-dpdf','-fillpage')

