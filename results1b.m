clear all;
clc;
%for model based method using Q-learning, (3,6) LDPC, n=196
snr=[0.5 1 1.5 2 2.25 2.5];

BER_fl=[0.0954367 0.0640801 0.0357781 0.0150315 0.00904184 0.00486937;
        0.096337 0.063141 0.0366772 0.0153579 0.00924462 0.00551171;
        0.0965251 0.0638192 0.0353939 0.0157973 0.00878995 0.0055135];
    
BER_GI=[0.0372108 0.0283358 0.0223479 0.0155169 0.014533 0.0113611;
        0.0398148 0.0326445 0.0231918 0.0173901 0.0143551 0.0122821;
        0.0380127 0.0290742 0.0217996 0.0175159 0.013941 0.0110787]; %random clustering
    
BER_NS=[0.0181406 0.0135059 0.00903524 0.00581614 0.00512258 0.00398093;
        0.0177137 0.012212 0.00940953 0.00585521 0.00493755 0.00418776;
        0.0177385 0.0123833 0.00859827 0.0058559 0.00465053 0.00387008];
               
BER_contg_clus=[0.013358 0.0107326 0.00874209 0.00633764 0.00556355 0.0052405;
                0.00660527 0.00525948 0.00454147 0.0031703 0.00295808 0.00272433;
                0.0105025 0.00858805 0.00735928 0.00544975 0.00464599 0.00417138];    
    
BER_ran_clus=[0.00580345 0.00492353 0.00385511 0.00356333 0.00303519 0.00275332;
              0.00827372 0.00674023 0.00597807 0.00467516 0.00418468 0.00363985;
              0.00733119 0.00588589 0.00459996 0.00447133 0.00338291 0.00332428]; 

% BER_opt_clus=[0.00625741 0.00539067 0.00467753 0.00366709 0.00325955 0.00307467;
%               0.00611172 0.00494577 0.00454317 0.00377384 0.00290838 0.00272432;
%               0.0065254 0.00544452 0.00460991 0.00367409 0.00350006 0.00322205]; 
          
BER_opt_clus=[0.00625741 0.00539067 0.00447753 0.00366709 0.00325955 0.00307467;
              0.00611172 0.00494577 0.00444317 0.00377384 0.00290838 0.00272432];          
    
BER_ran_clus_TS=[0.00763297 0.00573356 0.00490064 0.00475956 0.00362913 0.00313993;
                 0.00833278 0.00669879 0.00580312 0.00447935 0.00415387 0.00345859;
                 0.00777103 0.00689655 0.00552786 0.00474098 0.0038486 0.00364668]; %trained with 5*10^5 samples

% BER_opt_clus_TS=[0.00483841 0.00409822 0.00334191 0.00290968 0.00256592 0.00254246;
%                  0.00689424 0.00536831 0.00411514 0.00361296 0.00309916 0.00272912;
%                  0.0077258 0.00638298 0.00520881 0.00407246 0.00384164 0.00333069]; %trained with 5*10^5 samples
             
BER_opt_clus_TS=[0.00483841 0.00409822 0.00334191 0.00290968 0.00256592 0.00254246;
                 0.00689424 0.00536831 0.00411514 0.00361296 0.00309916 0.00272912];             
                          
BER_NSTS=[0.0269024 0.0204294 0.0165568 0.0122214 0.0100374 0.00877653;
          0.0291061 0.0228019 0.0169599 0.0121298 0.00972133 0.00882178;
          0.0268415 0.0218543 0.0173932 0.0123244 0.0107632 0.00835217];
    

ncv_fl=[27052 21536.9 13107.2 6019.81 3880.02 2211.31;
        27196.8 21509.3 13706.9 6545.93 4024.28 2580.71;
        26873.2 22104.4 13168.9 6384.02 3904.4 2706];

ncv_GI=[302.869 260.805 234.022 199.072 197.628 171.916;
        320.115 294.051 239.247 215.08 199.097 180.894;
        303.682 272.351 230.397 218.643 187.442 169.155];  

ncv_NS=[298.963 278.169 230.319 199.462 193.422 169.365;
        291.517 251.651 233.684 204.645 187.918 181.875;
        288.109 266.372 224.182 206.439 186.199 169.042]; 

ncv_contg_clus=[359.274 310.853 264.602 219.918 203.663 193.926;
              339.47 301.724 271.231 209.478 207.09 195.647;
              354.275 284.633 262.608 224.278 202.771 180.352];
    
ncv_ran_clus=[295.932 259.079 220.644 200.835 178.08 173.339;
              309.998 275.969 252.935 216.771 201.34 184.267;
              324.313 288.949 232.394 222.895 188.477 187.173]; 
    
ncv_opt_clus=[312.577 274.653 245.88 211.5 196.765 182.068;
              171.136 163.133 140.913 130.166 134.047 128.431;
              306.978 272.014 241.501 200.312 200.459 179.451];

ncv_ran_clus_TS=[307.465 258.528 234.526 200.687 195.429 179.34;
              334.68 290.667 252.753 212.976 206.048 177.846;
              301.734 272.483 244.741 214.635 190.339 179.786]; 
    
ncv_opt_clus_TS=[315.793 270.364 242.881 214.099 192.224 185.074;
                 305.941 266.626 229.927 215.047 182.04 169.013;
                 307.304 269.311 239.354 218.589 195.171 181.844];
             
ncv_NSTS=[253.377 436.133 597.742 670.628 742.185 886.042;
          275.865 460.523 594.423 657.504 747.035 836.768;
          254.185 455.41 632.592 691.442 784.113 833.009];           
     
% hold on
figure(1)
% semilogy(snr,mean(BER_fl),'-.o',snr,mean(BER_GI),'-.*',snr,mean(BER_NS),'-.<',snr,mean(BER_NSTS),'-.x',snr,mean(BER_contg_clus),'-.s',...
% snr,mean(BER_ran_clus),'-.>',snr,mean(BER_opt_clus),'-.^','LineWidth',4,'markers',15)  

semilogy(snr,mean(BER_fl),'-.o',snr,mean(BER_GI),'-.*',snr,mean(BER_NSTS),'-.x',snr,mean(BER_NS),'-.<',snr,mean(BER_ran_clus),'-.s',...
snr,mean(BER_opt_clus),'-.>',snr,mean(BER_ran_clus_TS),'-.^',snr,mean(BER_opt_clus_TS),'-.d','LineWidth',4,'markers',15)  

% title ('Results for $(3,6)$ LDPC code, $n=196$, $\ell_{\max}=25$','interpreter','latex')
xlabel ('$E_b/N_0$ (dB)','interpreter','latex')
ylabel ('BER','interpreter','latex')
%annotation('textbox',[.9 .5 .1 .2],'String','$\ell_{\max}$ is the max. no. of decoder iterations, $\mu$ is the mean no. of CN to VN messages over all data points','EdgeColor','none','interpreter','latex')


% l=legend( 'flooding',... 
%     'MGI',...
%     'NS',...
%     'NS-TS',...
%     'MQC',...
%     'MQR',...
%     'MQO',...
%     'location','northwest')
    
l=legend( 'flooding',... 
    'GI',...
    'NS-TS',...
    'NS',...
    'QR',...
    'QO',...
    'QR-TS',...
    'QO-TS',...
    'location','northwest')
    
% l.FontSize=14;

grid on
set(legend,'Interpreter','latex');
set(gca,'fontsize',22)
orient(figure(1),'landscape')
print('res','-dpdf','-fillpage')

format longG

% mean(ncv_fl)
% mean(ncv_GI)
% mean(ncv_NSTS)
% mean(ncv_NS)
% mean(ncv_contg_clus)
% mean(ncv_ran_clus)
% mean(ncv_opt_clus)
mean(ncv_ran_clus_TS)
mean(ncv_opt_clus_TS)

