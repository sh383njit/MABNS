
%from L=2 or 3 terminally lifted AB SC matrix, construct a larger L matrx

clear all;
clc;

% id = fopen('mval.txt','r'); 
% m=fscanf(id,'%d')'; 
% fclose(id); 
% 
% id2 = fopen('nval.txt','r'); 
% n=fscanf(id2,'%d')'; 
% fclose(id2);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% not for uncoupled codes %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%W=L

m=700; n=735; p=7; gama=4; mem=2; L=2*(mem+1); J=5; %even for global code, gama=4 since we extract it from the col. wt. 4 sub-code

id = fopen('mat_sc2.txt','r'); %mat_sc1 is sub-code 1 (col. wt. 4) and mat_sc2 is the global code (col. wt. 3) generated by main4
tmp=fscanf(id,'%d'); 
fclose(id);

for i=1:m 
    H(i,:)=tmp((i-1)*n+1:i*n); 
end

% H

 for i=1:m
     rw(i)=sum(H(i,:));
 end
 
 for i=1:n
     cw(i)=sum(H(:,i));
 end    
%     cw
%     rw

m2=gama*p*(L+mem)*J;
n2=J*L*p^2;
H2=zeros(m2,n2); %extended matrix

for i=1:m
    for j=1:n
        H2(i,j)=H(i,j);
    end
end

jmp_r=(2*mem+1)*gama*p*J;
jmp_c=(mem+1)*J*p^2;
    
for i=mem+1:L-(mem+1)
    strt_r=i*gama*p*J;
    strt_c=i*J*p^2;
    
    H2(strt_r+1:strt_r+jmp_r,strt_c+1:strt_c+jmp_c)=H(1:jmp_r,1:jmp_c);
end

 for i=1:n2
     cw(i)=sum(H2(:,i));
 end 
 
 for j=1:m2
     rw(j)=sum(H2(j,:));
 end 
    cw
    rw

fileID = fopen('mat_sc.txt','w');
fprintf(fileID,'%d ',H2');
fclose(fileID);

fileID = fopen('mval.txt','w');
fprintf(fileID,'%d ',m2);
fclose(fileID);

fileID = fopen('nval.txt','w');
fprintf(fileID,'%d ',n2);
fclose(fileID);

m2
n2

% %creating window for windowed decoding
% m3=m2-mem*gama*J*p
% 
% for i=1:n2
%     for j=1:m3
%         H3(j,i)=H2(j,i);
%     end
% end
%     
% %  for i=1:n2
% %      cw(i)=sum(H3(:,i));
% %  end    
% %     cw
% 
% fileID = fopen('win_3_sc.txt','w');
% fprintf(fileID,'%d ',H3');
% fclose(fileID);
% 
% fileID = fopen('m_win.txt','w');
% fprintf(fileID,'%d ',m3);
% fclose(fileID);
% 
% fileID = fopen('W.txt','w');
% fprintf(fileID,'%d ',L);
% fclose(fileID);
