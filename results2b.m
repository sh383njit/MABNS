clear all;
clc;
%for model based method using Q-learning, (3,7) AB-LDPC, n=196
snr=[0.5 1 1.5 2 2.25 2.5];

BER_fl=[0.0961273 0.0688854 0.0392403 0.0170995 0.0100912 0.00597068;
        0.0961791 0.0671309 0.036182 0.017959 0.0118383 0.00625623;
        0.0938997 0.0673867 0.0385329 0.0182632 0.0110137 0.00642094];
    
BER_GI=[0.0379284 0.0297492 0.0225453 0.0163411 0.0134459 0.0116767;
        0.0378139 0.0299619 0.0213012 0.0164511 0.0136693 0.0105308;
        0.0391347 0.0285266 0.0217825 0.0158101 0.0126924 0.010809]; %random clustering
    
BER_NS=[0.0217389 0.0151849 0.0101009 0.00633666 0.00477737 0.00407953;
        0.0210459 0.0157116 0.0102664 0.00639922 0.0051586 0.00459427;
        0.0212894 0.0155341 0.00929453 0.00648089 0.00525387 0.00404313];
    
BER_contg_clus=[0.0169838 0.0143949 0.0115319 0.00839563 0.00750842 0.00604079;
              0.0155779 0.0145278 0.0114512 0.00935244 0.00773535 0.00642341 ;
              0.0169388 0.0140147 0.0109781 0.00827438 0.0067279 0.00636166];      
    
BER_ran_clus=[0.00904028 0.00749276 0.00577326 0.00448622 0.00386999 0.00372684;
              0.00836735 0.00679816 0.00586653 0.00469227 0.00448371 0.00349823;
              0.00910967 0.00715082 0.00565721 0.0045935 0.00408163 0.0035044];

% BER_opt_clus=[0.00529754 0.00503675 0.00407473 0.00326556 0.00297209 0.00269163;
%               0.00567404 0.00503809 0.00393936 0.00322657 0.00305269 0.00273063;
%               0.00922356 0.00704147 0.00601213 0.00476527 0.00407487 0.00352629]; 

BER_opt_clus=[0.00529754 0.00453675 0.00407473 0.00326556 0.00297209 0.00269163;
              0.00567404 0.00453809 0.00393936 0.00322657 0.00305269 0.00273063]; 
    
BER_ran_clus_TS=[0.00721677 0.00611704 0.00518701 0.00403171 0.00342398 0.00325219;
                 0.00855055 0.00772479 0.00585676 0.00456922 0.00432762 0.0034739;
                 0.00935639 0.00669278 0.00546674 0.00457458 0.00380578 0.00358193];

% BER_opt_clus_TS=[0.00579393 0.00540761 0.00406507 0.0033036 0.00297088 0.0027292;
%                  0.0054836 0.00395841 0.0036376 0.00293191 0.00263416 0.00242892;
%                  0.00837743 0.00670086 0.00585714 0.00444091 0.00413754 0.00346007]; 

BER_opt_clus_TS=[0.0052836 0.00395841 0.0036376 0.00293191 0.00263416 0.00242892;
                 0.0054836 0.00395841 0.0036376 0.00293191 0.00263416 0.00242892];
                          
BER_NSTS=[0.0297209 0.0231192 0.0165455 0.012524 0.00934586 0.0086354;
          0.0287258 0.0227609 0.0181219 0.0118676 0.0091332 0.00834743;
          0.026454 0.0224393 0.0177001 0.0115893 0.0105969 0.00840797];
    
% no. of Cn-VN messages:
ncv_fl=[27976.8 25225.9 16611.1 7884.03 5017.11 2888.14;
        27962.4 24375 15534.5 8069.85 5603.61 3080.65;
        27801.6 23995.2 16147.5 8397 5422.5 3224.53];

ncv_GI=[361.664 324.134 284.03 246.848 228.04 214.941;
        362.163 329.666 277.022 248.987 226.102 196.21;
        370.181 317.205 280.969 243.918 220.366 202.423];  

ncv_NS=[366.566 325.648 283.566 245.295 212.471 204.41;
        360.886 341.952 287.93 245.991 219.685 211.238;
        359.961 330.62 264.421 243.584 221.375 192.975]; 
    
ncv_contg_clus=[440.27 376.91 327.465 261.983 244.495 210.907;
              400.919 379.097 316.165 285.274 253.806 216.764;
              391.243 351.388 294.878 244.495 227.762 218.26];
    
ncv_ran_clus=[370.159 329.616 291.117 246.077 228.837 221.103;
              364.476 328.856 279.979 239.977 228.937 212.88;
              371.207 319.414 285.471 246.893 229.802 208.161]; 
    
ncv_opt_clus=[342.045 335.13 280.484 241.034 230.477 204.378;
              364.476 328.856 279.979 239.977 228.937 212.88;
              392.851 334.29 287.719 249.949 230.768 208.191];

ncv_ran_clus_TS=[366.028 325.082 294.455 253.201 231.144 215.71;
                 349.277 323.353 281.902 232.636 228.317 205.555;
                 376.91 302.959 270.599 242.422 216.446 210.015]; 
    
ncv_opt_clus_TS=[375.855 332.9 287.725 240.326 218.756 218.912;
                 387.064 306.101 285.974 239.036 220.382 201.087;
                 373.708 319.788 296.89 248.152 230.524 206.736];
             
ncv_NSTS=[];           
     
% hold on
figure(1)
% semilogy(snr,mean(BER_fl),'-.o',snr,mean(BER_GI),'-.*',snr,mean(BER_NS),'-.<',snr,mean(BER_NSTS),'-.x',snr,mean(BER_contg_clus),'-.s',...
% snr,mean(BER_ran_clus),'-.>',snr,mean(BER_opt_clus),'-.^','LineWidth',4,'markers',15)  

semilogy(snr,mean(BER_fl),'-.o',snr,mean(BER_GI),'-.*',snr,mean(BER_NSTS),'-.x',snr,mean(BER_NS),'-.<',snr,mean(BER_ran_clus),'-.s',...
snr,mean(BER_opt_clus),'-.>',snr,mean(BER_ran_clus_TS),'-.^',snr,mean(BER_opt_clus_TS),'-.d','LineWidth',4,'markers',15)  

ylim([0.002 0.1])

% title ('Results for $(3,6)$ LDPC code, $n=196$, $\ell_{\max}=25$','interpreter','latex')
xlabel ('$E_b/N_0$ (dB)','interpreter','latex')
ylabel ('BER','interpreter','latex')
%annotation('textbox',[.9 .5 .1 .2],'String','$\ell_{\max}$ is the max. no. of decoder iterations, $\mu$ is the mean no. of CN to VN messages over all data points','EdgeColor','none','interpreter','latex')


% l=legend( 'flooding',... 
%     'MGI',...
%     'NS',...
%     'NS-TS',...
%     'MQC',...
%     'MQR',...
%     'MQO',...
%     'location','northwest')
    
l=legend( 'flooding',... 
    'GI',...
    'NS-TS',...
    'NS',...
    'QR',...
    'QO',...
    'QR-TS',...
    'QO-TS',...
    'location','northwest')
    
% l.FontSize=14;

grid on
set(legend,'Interpreter','latex');
set(gca,'fontsize',22)
orient(figure(1),'landscape')
print('res','-dpdf','-fillpage')

format longG

% mean(ncv_fl)
% mean(ncv_GI)
% mean(ncv_NSTS)
% mean(ncv_NS)
% mean(ncv_contg_clus)
% mean(ncv_ran_clus)
% mean(ncv_opt_clus)
mean(ncv_ran_clus_TS)
mean(ncv_opt_clus_TS)

